<%- include("./partials/header") %>
<p id="geoloc"></p> <button onclick="getLocation()">abs</button>
    <form action="./amenities" method="GET">
        &ensp;
        <label for="service">Service :</label>
        <input type="text" id="service" name="service" value="" placeholder="Service you looking for">
        &ensp;
        <label for="radius">Search Radius :</label>
              
        <input type="button" value="-" onClick="subtract_one()"> 0
        <input type="range" id="radius" min="0" max="100000" step="1" name="radius" value="50000" onchange="show_value(this.value); show_value1(this.value)" placeholder="Search radius you looking in">
        <input type="button" value="+" onClick="add_one()"> 100000 :
        <span id="slider_value" style="color:red;font-weight:bold;"></span>
        <label>meter(s) = </label>
        <span id="slider_value1" style="color:red;font-weight:bold;"></span>
        <label>kilometers(s)</label>
        &ensp;
        <input type="submit" value="Submit">
    </form>
    <script src="geo.js"></script>
    <script>
        show_value(document.getElementById("radius").value);
        show_value1(document.getElementById("radius").value);
            function show_value(x)
            {
            document.getElementById("slider_value").innerHTML=x;
            }
            function show_value1(x)
            {
            document.getElementById("slider_value1").innerHTML=x/1000;
            }
            function add_one()
            {
            document.getElementById("radius").value=parseInt(document.getElementById("radius").value)+1000;
            show_value(document.getElementById("radius").value);
            show_value1(document.getElementById("radius").value);
            }
            function subtract_one()
            {
            document.getElementById("radius").value=parseInt(document.getElementById("radius").value)-1000;
            show_value(document.getElementById("radius").value);
            show_value1(document.getElementById("radius").value);
            }
    </script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-core.js" type="text/javascript"></script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-service.js" type="text/javascript"></script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-ui.js" type="text/javascript"></script>    
    <script>
        
        var platform = new H.service.Platform({
            'apikey': "rMWNJfAV2zeVVEYh5jOh8Lk4Qka34bkEmpOszDwDoik"
        });
        var geocoder = platform.getSearchService();
        function geocodeAndSearch(){
            var rad = prompt("Define Search Radius (in meters) : ");
            let geocodeParam ={
                q: 'hospitals',
                in: 'circle:'+ map.getCenter().lat +',' + map.getCenter().lng +';r='+rad
                        
            }
            function onResult(result){
                console.log(result);
                if(result.items.length>0){
                    for(var i =0 ; i < result.items.length ; i++){
                        var mkr = new H.map.Marker(result.items[i].position);
                        map.addObject(mkr);
                        mkr.setData(result.items[i].title + ' (' + result.items[i].distance +' m)');
                    }
                    
                }
                ui.addBubble(new H.ui.InfoBubble(result.items[0].position,{
                    content: result.items[0].title + ' (' + result.items[0].distance +' m)'
                }));
                document.getElementById("status").innerHTML = result.items.length + " Hospitals Found in " + rad + " meters";        
                //info bubble
                         
            }
            geocoder.discover(geocodeParam,onResult, alert);
                          
        }
    </script>
    <script src="geo.js"></script>
<!--<%- include("./partials/footer") %> -->